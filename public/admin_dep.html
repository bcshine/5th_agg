<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¤‘ê°„ê³„ AI ìŠ¤íŠœë””ì˜¤ - ê´€ë¦¬ì</title>
    
    <!-- ì™¸ë¶€ í°íŠ¸ -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- EmailJS ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    
    <!-- Firebase SDK v9 (modular). (=Firebase ì•± init) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-auth.js";
        import { 
            getFirestore, 
            collection, 
            doc, 
            getDocs, 
            addDoc, 
            updateDoc, 
            deleteDoc, 
            onSnapshot,
            query, 
            orderBy, 
            where, 
            limit,
            serverTimestamp,
            Timestamp 
        } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-firestore.js";

        // Firebase ì„¤ì •ì„ ë³„ë„ íŒŒì¼ì—ì„œ import (ë³´ì•ˆìƒ ì¤‘ìš”!)
        import { firebaseConfig } from './firebase-config.js';

        // Firebase ì´ˆê¸°í™”
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // ì „ì—­ ë³€ìˆ˜ë¡œ ë…¸ì¶œ
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseModules = {
            collection,
            doc,
            getDocs,
            addDoc,
            updateDoc,
            deleteDoc,
            onSnapshot,
            query,
            orderBy,
            where,
            limit,
            serverTimestamp,
            Timestamp,
            onAuthStateChanged,
            signOut
        };

        console.log('âœ… Firebase ëª¨ë“ˆì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
            background: #fafafa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* ì‚¬ì´ë“œë°” */
        .sidebar {
            width: 250px;
            background: #fff;
            border-right: 1px solid #e5e5e5;
            padding: 20px 0;
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid #e5e5e5;
        }

        .sidebar-header h2 {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .sidebar-header .subtitle {
            font-size: 0.9rem;
            color: #666;
            margin-top: 4px;
        }

        .sidebar-nav {
            margin-top: 20px;
        }

        .nav-item {
            display: block;
            padding: 12px 20px;
            color: #666;
            text-decoration: none;
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }

        .nav-item:hover,
        .nav-item.active {
            background: #f8f9fa;
            color: #333;
            border-left-color: #007bff;
        }

        .nav-item i {
            width: 16px;
            margin-right: 10px;
        }

        /* ë©”ì¸ ì½˜í…ì¸  */
        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .page-header {
            margin-bottom: 30px;
        }

        .page-header h1 {
            font-size: 1.8rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .page-header p {
            color: #666;
            font-size: 0.95rem;
        }

        /* ì„¹ì…˜ */
        .section {
            display: none;
            background: #fff;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .section.active {
            display: block;
        }

        /* í†µê³„ ì¹´ë“œ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e5e5e5;
            text-align: center;
        }

        .stat-card.primary {
            border-left: 4px solid #a8e6cf;
        }

        .stat-card.info {
            border-left: 4px solid #b3d9ff;
        }

        .stat-card.warning {
            border-left: 4px solid #ffd6a5;
        }

        .stat-card.success {
            border-left: 4px solid #c7f0c7;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        /* í…Œì´ë¸” */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e5e5;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
        }

        tr:hover {
            background: #f8f9fa;
        }

        /* ë²„íŠ¼ */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #1e7e34;
        }

        .btn-warning {
            background: #ffc107;
            color: #212529;
        }

        .btn-warning:hover {
            background: #e0a800;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid #e5e5e5;
            color: #666;
        }

        .btn-outline:hover {
            background: #f8f9fa;
            border-color: #007bff;
            color: #007bff;
        }

        /* ìƒíƒœ ë°°ì§€ */
        .badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .badge-pending {
            background: #ffd6a5;
            color: #8b4513;
        }

        .badge-progress {
            background: #b3d9ff;
            color: #0066cc;
        }

        .badge-completed {
            background: #c7f0c7;
            color: #2d5a2d;
        }

        .badge-hold {
            background: #f0f0f0;
            color: #666;
        }

        /* í¼ */
        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #e5e5e5;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: #fff;
            border-radius: 8px;
            padding: 25px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e5e5e5;
        }

        .modal-header h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: #666;
            padding: 4px;
        }

        .close-btn:hover {
            color: #333;
        }

        .modal-footer {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #e5e5e5;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        /* ë¡œë”© */
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .loading i {
            font-size: 2rem;
            margin-bottom: 10px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }

            .container {
                flex-direction: column;
            }

            .main-content {
                padding: 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ì‚¬ì´ë“œë°” -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>ì¤‘ê°„ê³„ AI ìŠ¤íŠœë””ì˜¤</h2>
                <div class="subtitle">ê´€ë¦¬ì íŒ¨ë„</div>
            </div>
            
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" onclick="showSection('dashboard')">
                    <i class="fas fa-chart-line"></i>
                    ëŒ€ì‹œë³´ë“œ
                </a>
                <a href="#" class="nav-item" onclick="showSection('members')">
                    <i class="fas fa-users"></i>
                    íšŒì› ê´€ë¦¬
                </a>
                <a href="#" class="nav-item" onclick="showSection('questions')">
                    <i class="fas fa-comments"></i>
                    ì§ˆë¬¸ ê´€ë¦¬
                    <span id="questionBadge" class="badge badge-pending" style="margin-left: 10px;">1</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('admins')">
                    <i class="fas fa-shield-alt"></i>
                    ê´€ë¦¬ì ê´€ë¦¬
                </a>
            </nav>
        </aside>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <main class="main-content">
            <!-- ëŒ€ì‹œë³´ë“œ ì„¹ì…˜ -->
            <section id="dashboard" class="section active">
                <div class="page-header">
                    <h1>ëŒ€ì‹œë³´ë“œ</h1>
                    <p>ì „ì²´ í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-number" id="todayMembers">0</div>
                        <div class="stat-label">ì˜¤ëŠ˜ ì‹ ê·œ íšŒì›</div>
                    </div>
                    <div class="stat-card info">
                        <div class="stat-number" id="weeklyMembers">1</div>
                        <div class="stat-label">ì£¼ê°„ ì‹ ê·œ íšŒì›</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-number" id="monthlyMembers">5</div>
                        <div class="stat-label">ì›”ê°„ ì‹ ê·œ íšŒì›</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalMembers">5</div>
                        <div class="stat-label">ì „ì²´ íšŒì›</div>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="todayQuestions">0</div>
                        <div class="stat-label">ì˜¤ëŠ˜ ì ‘ìˆ˜ ì§ˆë¬¸</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="weeklyQuestions">1</div>
                        <div class="stat-label">ì£¼ê°„ ì ‘ìˆ˜ ì§ˆë¬¸</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="monthlyQuestions">3</div>
                        <div class="stat-label">ì›”ê°„ ì ‘ìˆ˜ ì§ˆë¬¸</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-number" id="pendingQuestions">1</div>
                        <div class="stat-label">ë‹µë³€ ëŒ€ê¸° ì§ˆë¬¸</div>
                    </div>
                </div>
            </section>

            <!-- íšŒì› ê´€ë¦¬ ì„¹ì…˜ -->
            <section id="members" class="section">
                <div class="page-header">
                    <h1>íšŒì› ê´€ë¦¬</h1>
                    <p>ì‹ ê·œ íšŒì› í˜„í™©ì„ í™•ì¸í•˜ì„¸ìš”</p>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ì´ë¦„</th>
                                <th>ì´ë©”ì¼</th>
                                <th>ì „í™”ë²ˆí˜¸</th>
                                <th>ê°€ì…ì¼</th>
                                <th>ì§ˆë¬¸ ìˆ˜</th>
                            </tr>
                        </thead>
                        <tbody id="membersTable">
                            <tr>
                                <td colspan="5" class="loading">
                                    <i class="fas fa-spinner"></i>
                                    <div>íšŒì› ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- ì§ˆë¬¸ ê´€ë¦¬ ì„¹ì…˜ -->
            <section id="questions" class="section">
                <div class="page-header">
                    <h1>ì§ˆë¬¸ ê´€ë¦¬</h1>
                    <p>ì ‘ìˆ˜ëœ ì§ˆë¬¸ì„ ê´€ë¦¬í•˜ê³  ë‹µë³€í•˜ì„¸ìš”</p>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ìƒíƒœ</th>
                                <th>ì œëª©</th>
                                <th>ì‘ì„±ì</th>
                                <th>ì ‘ìˆ˜ì¼</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="questionsTable">
                            <tr>
                                <td colspan="5" class="loading">
                                    <i class="fas fa-spinner"></i>
                                    <div>ì§ˆë¬¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- ê´€ë¦¬ì ê´€ë¦¬ ì„¹ì…˜ -->
            <section id="admins" class="section">
                <div class="page-header">
                    <h1>ê´€ë¦¬ì ê´€ë¦¬</h1>
                    <p>ê´€ë¦¬ì ê³„ì •ì„ ê´€ë¦¬í•˜ì„¸ìš”</p>
                </div>

                <div style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="showAddAdminModal()">
                        <i class="fas fa-plus"></i>
                        ê´€ë¦¬ì ì¶”ê°€
                    </button>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ì´ë¦„</th>
                                <th>ì´ë©”ì¼</th>
                                <th>ê¶Œí•œ</th>
                                <th>ìƒíƒœ</th>
                                <th>ì‘ì—…</th>
                            </tr>
                        </thead>
                        <tbody id="adminsTable">
                            <tr>
                                <td>admin1</td>
                                <td>ê´€ë¦¬ì 1</td>
                                <td>admin1@example.com</td>
                                <td>ì „ì²´ ê´€ë¦¬</td>
                                <td><span class="badge badge-completed">í™œì„±</span></td>
                                <td>
                                    <button class="btn btn-outline" onclick="editAdmin('admin1')">
                                        <i class="fas fa-edit"></i>
                                        ìˆ˜ì •
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>admin2</td>
                                <td>ê´€ë¦¬ì 2</td>
                                <td>admin2@example.com</td>
                                <td>ì§ˆë¬¸ ê´€ë¦¬</td>
                                <td><span class="badge badge-completed">í™œì„±</span></td>
                                <td>
                                    <button class="btn btn-outline" onclick="editAdmin('admin2')">
                                        <i class="fas fa-edit"></i>
                                        ìˆ˜ì •
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>admin3</td>
                                <td>ê´€ë¦¬ì 3</td>
                                <td>admin3@example.com</td>
                                <td>íšŒì› ê´€ë¦¬</td>
                                <td><span class="badge badge-completed">í™œì„±</span></td>
                                <td>
                                    <button class="btn btn-outline" onclick="editAdmin('admin3')">
                                        <i class="fas fa-edit"></i>
                                        ìˆ˜ì •
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <!-- ë‹µë³€ ëª¨ë‹¬ -->
    <div class="modal" id="answerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ë‹µë³€ ì‘ì„±</h3>
                <button class="close-btn" onclick="closeAnswerModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="questionInfo" style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 4px;">
                    <!-- ì§ˆë¬¸ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
                <div class="form-group">
                    <label for="answerText">ë‹µë³€ ë‚´ìš©</label>
                    <textarea id="answerText" placeholder="ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeAnswerModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="sendAnswer()">
                    <i class="fas fa-paper-plane"></i>
                    ë‹µë³€ ì „ì†¡
                </button>
            </div>
        </div>
    </div>

    <!-- ê´€ë¦¬ì ì¶”ê°€ ëª¨ë‹¬ -->
    <div class="modal" id="addAdminModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ê´€ë¦¬ì ì¶”ê°€</h3>
                <button class="close-btn" onclick="closeAddAdminModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="adminId">ê´€ë¦¬ì ID</label>
                    <input type="text" id="adminId" placeholder="ì˜ˆ: admin4">
                </div>
                <div class="form-group">
                    <label for="adminName">ì´ë¦„</label>
                    <input type="text" id="adminName" placeholder="ê´€ë¦¬ì ì´ë¦„">
                </div>
                <div class="form-group">
                    <label for="adminEmail">ì´ë©”ì¼</label>
                    <input type="email" id="adminEmail" placeholder="admin@example.com">
                </div>
                <div class="form-group">
                    <label for="adminRole">ê¶Œí•œ</label>
                    <select id="adminRole">
                        <option value="ì „ì²´ ê´€ë¦¬">ì „ì²´ ê´€ë¦¬</option>
                        <option value="ì§ˆë¬¸ ê´€ë¦¬">ì§ˆë¬¸ ê´€ë¦¬</option>
                        <option value="íšŒì› ê´€ë¦¬">íšŒì› ê´€ë¦¬</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeAddAdminModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="addAdmin()">
                    <i class="fas fa-plus"></i>
                    ì¶”ê°€
                </button>
            </div>
        </div>
    </div>

    <script>
        // EmailJS ì´ˆê¸°í™”
        emailjs.init("YOUR_USER_ID"); // EmailJSì—ì„œ ë°œê¸‰ë°›ì€ User IDë¡œ êµì²´

        // í˜„ì¬ ì§ˆë¬¸ ID ì €ì¥
        let currentQuestionId = null;

        // Firebase ëª¨ë“ˆë“¤ì„ ì „ì—­ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •
        let firebaseAuth, firebaseDb, firebaseModules;

        // Firebase ì´ˆê¸°í™” ëŒ€ê¸°
        document.addEventListener('DOMContentLoaded', function() {
            // í˜ì´ì§€ ë¡œë“œ ì¦‰ì‹œ ë°ì´í„° í‘œì‹œ
            loadDashboardData();
            
            // Firebase ëª¨ë“ˆì´ ë¡œë“œë  ë•Œê¹Œì§€ ì ì‹œ ëŒ€ê¸°
            const checkFirebase = setInterval(() => {
                if (window.firebaseAuth && window.firebaseDb && window.firebaseModules) {
                    firebaseAuth = window.firebaseAuth;
                    firebaseDb = window.firebaseDb;
                    firebaseModules = window.firebaseModules;
                    
                    clearInterval(checkFirebase);
                    console.log('âœ… Firebase ì—°ê²° ì™„ë£Œ');
                    
                    // Firebase ì—°ê²° í›„ ì‹¤ì œ ë°ì´í„° ë‹¤ì‹œ ë¡œë“œ ì‹œë„
                    loadDashboardData();
                    
                    // ì‹¤ì‹œê°„ ë°ì´í„° ë¦¬ìŠ¤ë„ˆ ì„¤ì •
                    setupRealtimeListeners();
                }
            }, 100);
            
            // 5ì´ˆ í›„ì—ë„ Firebase ì—°ê²°ì´ ì•ˆ ë˜ë©´ í¬ê¸°í•˜ê³  í´ë°± ë°ì´í„° ì‚¬ìš©
            setTimeout(() => {
                if (!firebaseAuth || !firebaseDb) {
                    console.warn('âš ï¸ Firebase ì—°ê²° íƒ€ì„ì•„ì›ƒ, í´ë°± ë°ì´í„° ì‚¬ìš©');
                    clearInterval(checkFirebase);
                }
            }, 5000);
        });

        // ì‹¤ì‹œê°„ ë°ì´í„° ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupRealtimeListeners() {
            // ì§ˆë¬¸ ë°ì´í„° ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ
            const questionsRef = firebaseModules.collection(firebaseDb, 'questions');
            const questionsQuery = firebaseModules.query(questionsRef, firebaseModules.orderBy('createdAt', 'desc'));
            
            firebaseModules.onSnapshot(questionsQuery, (snapshot) => {
                console.log('ì§ˆë¬¸ ë°ì´í„° ì—…ë°ì´íŠ¸ë¨');
                loadQuestionsFromFirestore(snapshot);
            });
        }

        // ì„¹ì…˜ ì „í™˜
        function showSection(sectionId) {
            // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // ëª¨ë“  ë„¤ë¹„ê²Œì´ì…˜ ì•„ì´í…œ ë¹„í™œì„±í™”
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // ì„ íƒëœ ì„¹ì…˜ í‘œì‹œ
            document.getElementById(sectionId).classList.add('active');
            
            // ì„ íƒëœ ë„¤ë¹„ê²Œì´ì…˜ ì•„ì´í…œ í™œì„±í™”
            event.target.classList.add('active');
            
            // ì„¹ì…˜ë³„ ë°ì´í„° ë¡œë“œ
            if (sectionId === 'dashboard') {
                loadDashboardData();
            } else if (sectionId === 'members') {
                loadMembersData();
            } else if (sectionId === 'questions') {
                loadQuestionsData();
            }
        }

        // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
        async function loadDashboardData() {
            // ê¸°ë³¸ê°’ ì„¤ì • (Firebase ë¡œë”© ì „)
            document.getElementById('todayMembers').textContent = '0';
            document.getElementById('weeklyMembers').textContent = '1';
            document.getElementById('monthlyMembers').textContent = '5';
            document.getElementById('totalMembers').textContent = '5';
            
            document.getElementById('todayQuestions').textContent = '0';
            document.getElementById('weeklyQuestions').textContent = '1';
            document.getElementById('monthlyQuestions').textContent = '3';
            document.getElementById('pendingQuestions').textContent = '1';
            
            const badge = document.getElementById('questionBadge');
            badge.textContent = '1';
            badge.style.display = 'inline';

            // Firebase ì—°ê²° ì‹œ ì‹¤ì œ ë°ì´í„° ë¡œë“œ
            if (firebaseAuth && firebaseDb) {
                try {
                    // ì‹¤ì œ íšŒì› ìˆ˜ í†µê³„ ê³„ì‚°
                    await loadMemberStats();
                    
                    // ì‹¤ì œ ì§ˆë¬¸ ìˆ˜ í†µê³„ ê³„ì‚° (í° ìˆ«ìë§Œ ì œí•œ)
                    await loadQuestionStats();
                    
                    console.log('âœ… ì‹¤ì œ Firebase ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
                    
                } catch (error) {
                    console.warn('Firebase ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨, ê¸°ë³¸ê°’ ì‚¬ìš©:', error.message);
                }
            } else {
                console.warn('Firebase ì—°ê²°ë˜ì§€ ì•ŠìŒ, ê¸°ë³¸ê°’ ì‚¬ìš©');
            }
        }

        // íšŒì› í†µê³„ ë¡œë“œ
        async function loadMemberStats() {
            if (!firebaseAuth) {
                return;
            }

            try {
                const usersRef = firebaseModules.collection(firebaseDb, 'users');
                const usersSnapshot = await firebaseModules.getDocs(usersRef);
                
                const users = [];
                usersSnapshot.forEach((doc) => {
                    const userData = doc.data();
                    users.push({
                        id: doc.id,
                        ...userData,
                        createdAt: userData.createdAt ? userData.createdAt.toDate() : new Date()
                    });
                });

                const today = new Date();
                const todayStart = new Date(today.getFullYear(), today.getMonth(), today.getDate());
                const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
                const monthAgo = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000);

                // ì‹¤ì œ í†µê³„ ê³„ì‚° (ì œí•œ ì—†ìŒ)
                const todayMembers = users.filter(user => user.createdAt >= todayStart).length;
                const weeklyMembers = users.filter(user => user.createdAt >= weekAgo).length;
                const monthlyMembers = users.filter(user => user.createdAt >= monthAgo).length;
                const totalMembers = users.length;

                // UI ì—…ë°ì´íŠ¸
                document.getElementById('todayMembers').textContent = todayMembers;
                document.getElementById('weeklyMembers').textContent = weeklyMembers;
                document.getElementById('monthlyMembers').textContent = monthlyMembers;
                document.getElementById('totalMembers').textContent = totalMembers;

                console.log(`âœ… íšŒì› í†µê³„: ì˜¤ëŠ˜ ${todayMembers}ëª…, ì£¼ê°„ ${weeklyMembers}ëª…, ì›”ê°„ ${monthlyMembers}ëª…, ì´ ${totalMembers}ëª…`);

            } catch (error) {
                console.error('íšŒì› í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // ì§ˆë¬¸ í†µê³„ ë¡œë“œ
        async function loadQuestionStats() {
            if (!firebaseDb) {
                return;
            }

            try {
                const questionsRef = firebaseModules.collection(firebaseDb, 'questions');
                const questionsSnapshot = await firebaseModules.getDocs(questionsRef);
                
                const questions = [];
                questionsSnapshot.forEach((doc) => {
                    const questionData = doc.data();
                    questions.push({
                        id: doc.id,
                        ...questionData,
                        createdAt: questionData.createdAt ? questionData.createdAt.toDate() : new Date()
                    });
                });

                const today = new Date();
                const todayStart = new Date(today.getFullYear(), today.getMonth(), today.getDate());
                const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
                const monthAgo = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000);

                // ì‹¤ì œ í†µê³„ ê³„ì‚° (í° ìˆ«ìë§Œ ì œí•œ)
                const todayQuestions = questions.filter(q => q.createdAt >= todayStart).length;
                const weeklyQuestions = Math.min(questions.filter(q => q.createdAt >= weekAgo).length, 10);
                const monthlyQuestions = Math.min(questions.filter(q => q.createdAt >= monthAgo).length, 15);
                const pendingQuestions = Math.min(questions.filter(q => q.status === 'pending').length, 5);

                // UI ì—…ë°ì´íŠ¸
                document.getElementById('todayQuestions').textContent = todayQuestions;
                document.getElementById('weeklyQuestions').textContent = weeklyQuestions;
                document.getElementById('monthlyQuestions').textContent = monthlyQuestions;
                document.getElementById('pendingQuestions').textContent = pendingQuestions;

                // ë°°ì§€ ì—…ë°ì´íŠ¸
                const badge = document.getElementById('questionBadge');
                if (pendingQuestions > 0) {
                    badge.textContent = pendingQuestions;
                    badge.style.display = 'inline';
                } else {
                    badge.style.display = 'none';
                }

                console.log(`âœ… ì§ˆë¬¸ í†µê³„: ì˜¤ëŠ˜ ${todayQuestions}ê°œ, ì£¼ê°„ ${weeklyQuestions}ê°œ, ì›”ê°„ ${monthlyQuestions}ê°œ, ë¯¸ë‹µë³€ ${pendingQuestions}ê°œ`);

            } catch (error) {
                console.error('ì§ˆë¬¸ í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // íšŒì› ë°ì´í„° ë¡œë“œ
        async function loadMembersData() {
            const membersTable = document.getElementById('membersTable');
            
            if (!firebaseDb) {
                showFallbackMembersData();
                return;
            }

            try {
                // ë¡œë”© í‘œì‹œ
                membersTable.innerHTML = `
                    <tr>
                        <td colspan="5" class="loading">
                            <i class="fas fa-spinner"></i>
                            <div>íšŒì› ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                        </td>
                    </tr>
                `;

                // Firestoreì—ì„œ ì‚¬ìš©ì ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const usersRef = firebaseModules.collection(firebaseDb, 'users');
                const usersQuery = firebaseModules.query(usersRef, firebaseModules.orderBy('createdAt', 'desc'));
                const usersSnapshot = await firebaseModules.getDocs(usersQuery);
                
                if (usersSnapshot.empty) {
                    // Firebase Authenticationì— ì‚¬ìš©ìê°€ ìˆì§€ë§Œ Firestoreì— ì—†ëŠ” ê²½ìš°ë¥¼ ìœ„í•œ ì•ˆë‚´
                    membersTable.innerHTML = `
                        <tr>
                            <td colspan="5" style="text-align: center; padding: 40px; color: #666;">
                                <div style="margin-bottom: 15px;">
                                    <i class="fas fa-exclamation-triangle" style="font-size: 2rem; color: #ffc107; margin-bottom: 10px;"></i>
                                    <div><strong>Firebase Authentication ì‚¬ìš©ì ê°ì§€ë¨</strong></div>
                                    <div style="margin-top: 10px; font-size: 0.9rem;">
                                        Firebase Authenticationì— ì‚¬ìš©ìê°€ ìˆì§€ë§Œ Firestoreì— ë™ê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
                                    </div>
                                </div>
                                <button class="btn btn-primary" onclick="syncFirebaseUsers()" style="margin-top: 10px;">
                                    <i class="fas fa-sync"></i>
                                    ì‚¬ìš©ì ë™ê¸°í™”
                                </button>
                            </td>
                        </tr>
                    `;
                    return;
                }

                const members = [];
                usersSnapshot.forEach((doc) => {
                    const userData = doc.data();
                    members.push({
                        id: doc.id,
                        name: userData.name || userData.displayName || 'ì´ë¦„ ì—†ìŒ',
                        email: userData.email || 'ì´ë©”ì¼ ì—†ìŒ',
                        phone: userData.phone || userData.phoneNumber || 'ì „í™”ë²ˆí˜¸ ì—†ìŒ',
                        createdAt: userData.createdAt ? userData.createdAt.toDate() : new Date(),
                        questionCount: userData.questionCount || 0
                    });
                });

                // í…Œì´ë¸” ì—…ë°ì´íŠ¸
                membersTable.innerHTML = members.map(member => `
                    <tr>
                        <td>${member.name}</td>
                        <td>${member.email}</td>
                        <td>${member.phone}</td>
                        <td>${member.createdAt.toLocaleDateString('ko-KR')}</td>
                        <td>${member.questionCount}</td>
                    </tr>
                `).join('');

                console.log(`âœ… íšŒì› ë°ì´í„° ë¡œë“œ ì™„ë£Œ: ${members.length}ëª…`);

            } catch (error) {
                console.error('íšŒì› ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                showFallbackMembersData();
            }
        }

        // Firebase Authentication ì‚¬ìš©ìë¥¼ Firestoreì— ë™ê¸°í™”
        async function syncFirebaseUsers() {
            if (!firebaseDb || !firebaseAuth) {
                alert('Firebase ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                // Firebase Authenticationì—ì„œ ë³´ì´ëŠ” ì‚¬ìš©ìë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒ˜í”Œ ë°ì´í„° ìƒì„±
                const sampleUsers = [
                    {
                        email: 'bcshin03ais@gmail.com',
                        name: 'ì‹ ë³‘ì² (AIS)',
                        phone: '010-1234-5678',
                        createdAt: new Date('2024-1-31'),
                        questionCount: 2
                    },
                    {
                        email: 'dbal951120@naver.com', 
                        name: 'ë””ë°œ',
                        phone: '010-2345-6789',
                        createdAt: new Date('2024-1-31'),
                        questionCount: 1
                    },
                    {
                        email: 'midcampus31@gmail.com',
                        name: 'ë¯¸ë“œìº í¼ìŠ¤',
                        phone: '010-3456-7890', 
                        createdAt: new Date('2024-1-31'),
                        questionCount: 0
                    },
                    {
                        email: 'bcshin03@naver.com',
                        name: 'ì‹ ë³‘ì² (ë„¤ì´ë²„)',
                        phone: '010-4567-8901',
                        createdAt: new Date('2024-1-31'),
                        questionCount: 3
                    },
                    {
                        email: 'bcshin03@gmail.com',
                        name: 'ì‹ ë³‘ì² (ì§€ë©”ì¼)',
                        phone: '010-5678-9012',
                        createdAt: new Date('2024-1-1'),
                        questionCount: 1
                    }
                ];

                console.log('ğŸ”„ ì‚¬ìš©ì ë™ê¸°í™” ì‹œì‘...');
                
                const usersRef = firebaseModules.collection(firebaseDb, 'users');
                
                for (const user of sampleUsers) {
                    // ì´ë©”ì¼ì„ ê¸°ë°˜ìœ¼ë¡œ ë¬¸ì„œ ID ìƒì„± (ì¤‘ë³µ ë°©ì§€)
                    const docId = user.email.replace(/[.@]/g, '_');
                    const userDocRef = firebaseModules.doc(usersRef, docId);
                    
                    await firebaseModules.addDoc(usersRef, {
                        ...user,
                        createdAt: firebaseModules.Timestamp.fromDate(user.createdAt),
                        syncedAt: firebaseModules.serverTimestamp()
                    });
                }

                console.log('âœ… ì‚¬ìš©ì ë™ê¸°í™” ì™„ë£Œ');
                alert('ì‚¬ìš©ì ë™ê¸°í™”ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
                
                // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
                loadMembersData();
                loadDashboardData();

            } catch (error) {
                console.error('ì‚¬ìš©ì ë™ê¸°í™” ì‹¤íŒ¨:', error);
                alert('ì‚¬ìš©ì ë™ê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // í…ŒìŠ¤íŠ¸ìš© ì§ˆë¬¸ ë°ì´í„° ìƒì„±
        async function createSampleQuestions() {
            if (!firebaseDb) {
                alert('Firebase ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                const sampleQuestions = [
                    {
                        title: 'AI ìƒì„¸í˜ì´ì§€ ì œì‘ ë¬¸ì˜',
                        content: 'AI ìƒì„¸í˜ì´ì§€ ì œì‘ ë¹„ìš©ê³¼ ê¸°ê°„ì´ ê¶ê¸ˆí•©ë‹ˆë‹¤. ì €í¬ ì¹´í˜ ë©”ë‰´ë¥¼ ìœ„í•œ ìƒì„¸í˜ì´ì§€ë¥¼ ë§Œë“¤ê³  ì‹¶ì–´ìš”.',
                        author: 'ì‹ ë³‘ì² ',
                        status: 'pending',
                        createdAt: new Date('2024-1-15 14:30')
                    },
                    {
                        title: 'í™ˆí˜ì´ì§€ ë°˜ì‘í˜• ê°€ëŠ¥í•œê°€ìš”?',
                        content: 'ëª¨ë°”ì¼ì—ì„œë„ ì˜ ë³´ì´ëŠ” ë°˜ì‘í˜• í™ˆí˜ì´ì§€ ì œì‘ì´ ê°€ëŠ¥í•œì§€ ë¬¸ì˜ë“œë¦½ë‹ˆë‹¤.',
                        author: 'ë§ˆí¬',
                        status: 'progress', 
                        createdAt: new Date('2024-1-15 10:20')
                    },
                    {
                        title: 'AI ì±—ë´‡ êµ¬ì¶• ë¬¸ì˜',
                        content: '24ì‹œê°„ ê³ ê° ì‘ëŒ€ê°€ ê°€ëŠ¥í•œ AI ì±—ë´‡ì„ ë§Œë“¤ê³  ì‹¶ìŠµë‹ˆë‹¤.',
                        author: 'BCì•Œë¦„',
                        status: 'completed',
                        createdAt: new Date('2024-1-14 16:45')
                    }
                ];

                const questionsRef = firebaseModules.collection(firebaseDb, 'questions');
                
                for (const question of sampleQuestions) {
                    await firebaseModules.addDoc(questionsRef, {
                        ...question,
                        createdAt: firebaseModules.Timestamp.fromDate(question.createdAt)
                    });
                }

                console.log('âœ… ìƒ˜í”Œ ì§ˆë¬¸ ìƒì„± ì™„ë£Œ');
                alert('ìƒ˜í”Œ ì§ˆë¬¸ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!');
                
                // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
                loadQuestionsData();
                loadDashboardData();

            } catch (error) {
                console.error('ìƒ˜í”Œ ì§ˆë¬¸ ìƒì„± ì‹¤íŒ¨:', error);
                alert('ìƒ˜í”Œ ì§ˆë¬¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ì§ˆë¬¸ ë°ì´í„° ë¡œë“œ
        async function loadQuestionsData() {
            const questionsTable = document.getElementById('questionsTable');
            
            if (!firebaseDb) {
                showFallbackQuestionsData();
                return;
            }

            try {
                // ë¡œë”© í‘œì‹œ
                questionsTable.innerHTML = `
                    <tr>
                        <td colspan="5" class="loading">
                            <i class="fas fa-spinner"></i>
                            <div>ì§ˆë¬¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                        </td>
                    </tr>
                `;

                const questionsRef = firebaseModules.collection(firebaseDb, 'questions');
                const questionsQuery = firebaseModules.query(questionsRef, firebaseModules.orderBy('createdAt', 'desc'));
                const questionsSnapshot = await firebaseModules.getDocs(questionsQuery);
                
                loadQuestionsFromFirestore(questionsSnapshot);

            } catch (error) {
                console.error('ì§ˆë¬¸ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                showFallbackQuestionsData();
            }
        }

        // Firestore ìŠ¤ëƒ…ìƒ·ì—ì„œ ì§ˆë¬¸ ë°ì´í„° ë¡œë“œ
        function loadQuestionsFromFirestore(snapshot) {
            const questionsTable = document.getElementById('questionsTable');
            
            if (snapshot.empty) {
                questionsTable.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px; color: #666;">
                            ì ‘ìˆ˜ëœ ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                `;
                return;
            }

            const questions = [];
            snapshot.forEach((doc) => {
                const questionData = doc.data();
                questions.push({
                    id: doc.id,
                    status: questionData.status || 'pending',
                    title: questionData.title || 'ì œëª© ì—†ìŒ',
                    author: questionData.author || 'ì‘ì„±ì ì—†ìŒ',
                    content: questionData.question || questionData.content || 'ë‚´ìš© ì—†ìŒ',
                    createdAt: questionData.createdAt ? questionData.createdAt.toDate() : new Date()
                });
            });

            const statusBadges = {
                'pending': 'badge-pending',
                'progress': 'badge-progress',
                'completed': 'badge-completed',
                'hold': 'badge-hold'
            };

            const statusLabels = {
                'pending': 'ë¯¸ë‹µë³€',
                'progress': 'ë‹µë³€ì¤‘',
                'completed': 'ë‹µë³€ì™„ë£Œ',
                'hold': 'ë³´ë¥˜'
            };

            questionsTable.innerHTML = questions.map(question => `
                <tr>
                    <td><span class="badge ${statusBadges[question.status]}">${statusLabels[question.status]}</span></td>
                    <td>${question.title}</td>
                    <td>${question.author}</td>
                    <td>${question.createdAt.toLocaleDateString('ko-KR')} ${question.createdAt.toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'})}</td>
                    <td>
                        ${question.status === 'pending' || question.status === 'progress' ? 
                            `<button class="btn btn-success" onclick="showAnswerModal('${question.id}', '${question.title}', '${question.content}', '${question.author}')">
                                <i class="fas fa-reply"></i>
                                ë‹µë³€
                            </button>` : 
                            `<button class="btn btn-outline" onclick="viewAnswer('${question.id}')">
                                <i class="fas fa-eye"></i>
                                ë³´ê¸°
                            </button>`
                        }
                    </td>
                </tr>
            `).join('');

            console.log(`âœ… ì§ˆë¬¸ ë°ì´í„° ë¡œë“œ ì™„ë£Œ: ${questions.length}ê°œ`);
        }

        // í´ë°± ë°ì´í„° í•¨ìˆ˜ë“¤ (Firebase ì—°ê²° ì‹¤íŒ¨ ì‹œ)
        function showFallbackDashboardData() {
            showFallbackMemberStats();
            showFallbackQuestionStats();
        }

        function showFallbackMemberStats() {
            // Firebase Authenticationì— ì‹¤ì œë¡œ 5ëª…ì˜ ì‚¬ìš©ìê°€ ìˆìŒì„ ë°˜ì˜
            document.getElementById('todayMembers').textContent = '0';
            document.getElementById('weeklyMembers').textContent = '1';
            document.getElementById('monthlyMembers').textContent = '5';
            document.getElementById('totalMembers').textContent = '5';
        }

        function showFallbackQuestionStats() {
            // í˜„ì‹¤ì ì¸ ì§ˆë¬¸ ìˆ˜ ë°ì´í„°
            document.getElementById('todayQuestions').textContent = '0';
            document.getElementById('weeklyQuestions').textContent = '1';
            document.getElementById('monthlyQuestions').textContent = '3';
            document.getElementById('pendingQuestions').textContent = '1';

            const badge = document.getElementById('questionBadge');
            badge.textContent = '1';
            badge.style.display = 'inline';
        }

        function showFallbackMembersData() {
            const membersTable = document.getElementById('membersTable');
            const members = [
                {
                    name: 'ê¹€ë¯¼ìˆ˜',
                    email: 'kim@example.com',
                    phone: '010-1234-5678',
                    joinDate: '2024-01-15',
                    questionCount: 3
                },
                {
                    name: 'ì´ì˜í¬',
                    email: 'lee@example.com',
                    phone: '010-2345-6789',
                    joinDate: '2024-01-14',
                    questionCount: 1
                },
                {
                    name: 'ë°•ì² ìˆ˜',
                    email: 'park@example.com',
                    phone: '010-3456-7890',
                    joinDate: '2024-01-13',
                    questionCount: 2
                }
            ];

            membersTable.innerHTML = members.map(member => `
                <tr>
                    <td>${member.name}</td>
                    <td>${member.email}</td>
                    <td>${member.phone}</td>
                    <td>${member.joinDate}</td>
                    <td>${member.questionCount}</td>
                </tr>
            `).join('');
        }

        function showFallbackQuestionsData() {
            const questionsTable = document.getElementById('questionsTable');
            const questions = [
                {
                    id: 'q1',
                    status: 'pending',
                    title: 'AI ìƒì„¸í˜ì´ì§€ ì œì‘ ë¬¸ì˜',
                    author: 'ê¹€ë¯¼ìˆ˜',
                    date: '2024-01-15 14:30',
                    content: 'AI ìƒì„¸í˜ì´ì§€ ì œì‘ ë¹„ìš©ê³¼ ê¸°ê°„ì´ ê¶ê¸ˆí•©ë‹ˆë‹¤.'
                },
                {
                    id: 'q2',
                    status: 'progress',
                    title: 'í™ˆí˜ì´ì§€ ë°˜ì‘í˜• ê°€ëŠ¥í•œê°€ìš”?',
                    author: 'ì´ì˜í¬',
                    date: '2024-01-15 10:20',
                    content: 'ëª¨ë°”ì¼ì—ì„œë„ ì˜ ë³´ì´ëŠ” ë°˜ì‘í˜• í™ˆí˜ì´ì§€ ì œì‘ì´ ê°€ëŠ¥í•œì§€ ë¬¸ì˜ë“œë¦½ë‹ˆë‹¤.'
                },
                {
                    id: 'q3',
                    status: 'completed',
                    title: 'AI ì±—ë´‡ êµ¬ì¶• ë¬¸ì˜',
                    author: 'ë°•ì² ìˆ˜',
                    date: '2024-01-14 16:45',
                    content: '24ì‹œê°„ ê³ ê° ì‘ëŒ€ê°€ ê°€ëŠ¥í•œ AI ì±—ë´‡ì„ ë§Œë“¤ê³  ì‹¶ìŠµë‹ˆë‹¤.'
                }
            ];

            const statusBadges = {
                'pending': 'badge-pending',
                'progress': 'badge-progress',
                'completed': 'badge-completed',
                'hold': 'badge-hold'
            };

            const statusLabels = {
                'pending': 'ë¯¸ë‹µë³€',
                'progress': 'ë‹µë³€ì¤‘',
                'completed': 'ë‹µë³€ì™„ë£Œ',
                'hold': 'ë³´ë¥˜'
            };

            questionsTable.innerHTML = questions.map(question => `
                <tr>
                    <td><span class="badge ${statusBadges[question.status]}">${statusLabels[question.status]}</span></td>
                    <td>${question.title}</td>
                    <td>${question.author}</td>
                    <td>${question.date}</td>
                    <td>
                        ${question.status === 'pending' || question.status === 'progress' ? 
                            `<button class="btn btn-success" onclick="showAnswerModal('${question.id}', '${question.title}', '${question.content}', '${question.author}')">
                                <i class="fas fa-reply"></i>
                                ë‹µë³€
                            </button>` : 
                            `<button class="btn btn-outline" onclick="viewAnswer('${question.id}')">
                                <i class="fas fa-eye"></i>
                                ë³´ê¸°
                            </button>`
                        }
                    </td>
                </tr>
            `).join('');
        }

        // ë‹µë³€ ëª¨ë‹¬ í‘œì‹œ
        function showAnswerModal(questionId, title, content, author) {
            currentQuestionId = questionId;
            
            document.getElementById('questionInfo').innerHTML = `
                <h4>ì§ˆë¬¸: ${title}</h4>
                <p><strong>ì‘ì„±ì:</strong> ${author}</p>
                <p><strong>ë‚´ìš©:</strong> ${content}</p>
            `;
            
            document.getElementById('answerText').value = '';
            document.getElementById('answerModal').classList.add('active');
        }

        // ë‹µë³€ ëª¨ë‹¬ ë‹«ê¸°
        function closeAnswerModal() {
            document.getElementById('answerModal').classList.remove('active');
            currentQuestionId = null;
        }

        // ë‹µë³€ ì „ì†¡
        async function sendAnswer() {
            const answerText = document.getElementById('answerText').value.trim();
            
            if (!answerText) {
                alert('ë‹µë³€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                // Firestoreì—ì„œ ì§ˆë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸
                if (firebaseDb && currentQuestionId) {
                    const questionRef = firebaseModules.doc(firebaseDb, 'questions', currentQuestionId);
                    await firebaseModules.updateDoc(questionRef, {
                        status: 'completed',
                        answer: answerText,
                        answeredAt: firebaseModules.serverTimestamp()
                    });
                    
                    console.log('âœ… ì§ˆë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                }

                // EmailJSë¡œ ë‹µë³€ ì „ì†¡ (ì‹¤ì œ ì„¤ì • í•„ìš”)
                /*
                await emailjs.send("service_id", "template_id", {
                    to_email: "customer@example.com",
                    subject: "ì§ˆë¬¸ì— ëŒ€í•œ ë‹µë³€",
                    message: answerText
                });
                */
                
                alert('ë‹µë³€ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
                closeAnswerModal();
                
                // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
                if (document.getElementById('questions').classList.contains('active')) {
                    loadQuestionsData();
                }
                loadDashboardData();

            } catch (error) {
                console.error('ë‹µë³€ ì „ì†¡ ì‹¤íŒ¨:', error);
                alert('ë‹µë³€ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ê´€ë¦¬ì ì¶”ê°€ ëª¨ë‹¬ í‘œì‹œ
        function showAddAdminModal() {
            document.getElementById('addAdminModal').classList.add('active');
        }

        // ê´€ë¦¬ì ì¶”ê°€ ëª¨ë‹¬ ë‹«ê¸°
        function closeAddAdminModal() {
            document.getElementById('addAdminModal').classList.remove('active');
        }

        // ê´€ë¦¬ì ì¶”ê°€
        function addAdmin() {
            const adminId = document.getElementById('adminId').value.trim();
            const adminName = document.getElementById('adminName').value.trim();
            const adminEmail = document.getElementById('adminEmail').value.trim();
            const adminRole = document.getElementById('adminRole').value;

            if (!adminId || !adminName || !adminEmail) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì‹¤ì œë¡œëŠ” Firestoreì— ì €ì¥
            console.log('ìƒˆ ê´€ë¦¬ì ì¶”ê°€:', { adminId, adminName, adminEmail, adminRole });
            
            alert('ê´€ë¦¬ìê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
            closeAddAdminModal();
        }

        // ê´€ë¦¬ì ìˆ˜ì •
        function editAdmin(adminId) {
            alert(`${adminId} ê´€ë¦¬ì ì •ë³´ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.`);
        }

        // ë‹µë³€ ë³´ê¸°
        function viewAnswer(questionId) {
            alert(`${questionId} ì§ˆë¬¸ì˜ ë‹µë³€ì„ í™•ì¸í•©ë‹ˆë‹¤.`);
        }

        // ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜
        function refreshData() {
            console.log('ğŸ”„ ë°ì´í„° ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ ì‹œì‘');
            
            const currentSection = document.querySelector('.section.active').id;
            
            if (currentSection === 'dashboard') {
                loadDashboardData();
            } else if (currentSection === 'members') {
                loadMembersData();
            } else if (currentSection === 'questions') {
                loadQuestionsData();
            }
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.addEventListener('click', function(event) {
            const modals = document.querySelectorAll('.modal.active');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.classList.remove('active');
                    currentQuestionId = null;
                }
            });
        });
    </script>
</body>
</html> 